var Embed=Quill.import("blots/embed");class Spoiler extends Embed{static create(e){let l=super.create(e);return l.innerHTML=e,l}}Spoiler.blotName="span",Spoiler.className="spoiler",Spoiler.tagName="span";var steamSpoiler=function(){var e=document.createElement("span"),l=quill.getSelection();l&&quill.insertEmbed(l.index,"span",e)};Quill.register({"formats/spoiler":Spoiler});var Delta=Quill.import("delta"),quill=new Quill("#editor",{modules:{toolbar:{container:"#toolbar",handlers:{spoiler:steamSpoiler}}},placeholder:"Write your review here!",theme:"snow"}),text=quill.container.firstChild.innerHTML;$('[data-toggle="tooltip"]').tooltip();var change=new Delta;function convertHTML(e){var l=e.replace(/<p>/g,"").replace(/<\/p>/g,"\n").replace(/<strong>/g,"[b]").replace(/<\/strong>/g,"[/b]").replace(/<h1>/g,"[h1]").replace(/<\/h1>/g,"[/h1]\n").replace(/<em>/g,"[i]").replace(/<\/em>/g,"[/i]").replace(/<u>/g,"[u]").replace(/<\/u>/g,"[/u]").replace(/<ol>/g,"[olist]\n").replace(/<\/ol>/g,"[/olist]\n").replace(/<ul>/g,"[list]\n").replace(/<\/ul>/g,"[/list]\n").replace(/<li>/g,"[*]").replace(/<\/li>/g,"\n").replace(/<br>/g,"\n").replace(/<a href="/g,"[url=").replace(/" target="_blank">/g,"]").replace(/<\/a>/g,"[/url]").replace(/<s>/g,"[strike]").replace(/<\/s>/g,"[/strike]").replace(/<blockquote>/g,"[quote=author]").replace(/<\/blockquote>/g,"[/quote]\n").replace(/<span class="spoiler">/g,"[spoiler]").replace(/<\/span>/g,"[/spoiler]").replace(/<pre spellcheck="false">/g,"[code]").replace(/<\/pre>/g,"[/code]\n").replace(/<code>/g,"[noparse]").replace(/<\/code>/g,"[/noparse]");$("#markup").html(l),$("#preview").html(e)}function CopyToClipboard(e){let l=document.createElement("textarea");l.id="t",l.style.height=0,document.body.appendChild(l),l.value=document.getElementById(e).innerText,document.querySelector("#t").select(),document.execCommand("copy"),document.body.removeChild(l),alert("Markup copied to clipboard!")}function pushFooter(){var e=$(window).height(),l=$("#footer").height(),t=$("#footer").position().top+l;t<e&&$("#footer").css("margin-top",e-t+10+"px")}quill.on("selection-change",(function(e,l,t){convertHTML(text=quill.container.firstChild.innerHTML),e?$("#editorWindow").addClass("active"):$("#editorWindow").removeClass("active")})),quill.on("text-change",(function(e,l,t){convertHTML(text=quill.container.firstChild.innerHTML),change=change.compose(e)})),$("#previewCollapse").on("show.bs.collapse",(function(){quill.blur(),console.log(text),document.getElementById("showBtn").innerHTML="Hide Preview"})),$("#previewCollapse").on("hide.bs.collapse",(function(){document.getElementById("showBtn").innerHTML="Show Preview",quill.focus()})),$("#closeBtn").click((function(){$("#help").fadeOut(1e3,(function(){pushFooter()}))})),setInterval((function(){change.length()>0&&(console.log("Saving changes",change),change=new Delta)}),5e3),window.onbeforeunload=function(){if(change.length()>0)return"There are unsaved changes. Are you sure you want to leave?"},$(document).ready((function(){pushFooter();var e=$(".fade");e.css({opacity:"0"}),e.fadeTo(500,1,"swing");const l=new Date,t=l.getDate(),o=l.toLocaleString("en-us",{month:"long"});$(".current-date").html(`${t} ${o}`)}));